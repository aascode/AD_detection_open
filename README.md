# AD Detection

Detecting Alzheimer's disease(AD) from spontaneous speech.

## Paper

- [1]	Liu Z, Guo Z, Ling Z, et al. Dementia Detection by Analyzing Spontaneous Mandarin Speech[C]//2019 Asia-Pacific Signal and Information Processing Association Annual Summit and Conference (APSIPA ASC). IEEE, 2019: 289-296.

- [2]	Liu Z, Guo Z, Ling Z, et al. Detecting Alzheimer's Disease from Speech Using Neural Networks with Bottleneck Features and Data Augmentation [C]// ICASSP 2021.



The code will be made public after the paper is published.

## Data Set

- DementiaBank corpus.
- Unpublished mandarin dataset.


## Repository Structure
```
├── ad_detection
│   ├── dlcode                         # Deep learning model
│   ├── feature_cn                     # feature extraction of mandarin dataset
│   ├── feature_en                     # feature extraction of dementia bank dataset
│   ├── mlcode                         # Traditional meachine learing model
│   ├── prepare_cn                     # Data preprocessing for mandarin dataset
│   ├── prepare_en                     # Data preprocessing for dementia bank dataset
│   │   └── pylangacq_modified
│   └── tool                           # Tools
│       └── opensmile_scripts
├── mfa_notebook
│   └── log
├── notebook                           # Jupyter notebooks of Dementia bank dataset
│   └── log
├── notebook_cn                        # Jupyter notebooks of mandarin dataset
├── ws_cn                              # Workspace of mandarin dataset. Similiar as ws_en
└── ws_en                              # Workspace of Dementia bank dataset
    ├── data                           # Preprocessed data or extracted feature
    │   ├── bottleneck
    │   │   ├── high_pass
    │   │   └── hp_aug
    │   ├── high-pass
    │   ├── speech_extract_b
    │   ├── speech_keep_b
    │   ├── speech_lsa_keep_b
    │   ├── tsv
    │   ├── tsv_sr
    │   ├── wav_hp_aug
    │   ├── wav_hp_lsa
    │   ├── wav_mono
    │   ├── wav_mono_norm
    │   └── wav_mp3
    ├── data_ori                       # Original data from Pitt corpus
    │   ├── ctrl
    │   │   └── cookie
    │   └── dementia
    │       └── cookie
    ├── fusion                         # Merged features
    ├── label                          # summary.csv  blacklist.csv
    ├── list                           # Results of feature merging, K-fold division and prediction
    │   ├── result
    │   ├── result_aug
    │   ├── result_bottleneck
    │   ├── result_bottleneck_aug
    │       ......
    │   ├── result_bottleneck_aug_FC256-CNN-LSTM-Attention
    │   ├── split
    │   ├── split_aug
    │   └── split_clps
    ├── mfa                            # Forced align using Montreal-Forced-Aligner(MFA)
    └── opensmile                      # Files generated by OpenSMILE toolkit
        ├── audio_features_CPE16_
            ......
        ├── audio_features_mfcc_
        └── audio_features_mfcc_aug

```

## How to run

1. Prepare data following steps in `run_en.sh` (DementiaBank Pitt corpus)

2. Split data to 10 folds using `notebook/ML7-DataPrepareAndSplit.ipynb`

3. 
- Train baseline models using `notebook/ML7-Test_acoustic_feature.ipynb`
- Train deeplearing models with bottleneck features: `notebook/DL2-LLDs-BottleNeck.ipynb`
- Train deeplearing models with OpenSMILE LLDs: `notebook/DL2-OpenSMILE_LLDs.ipynb`

## Note

The `*.py` files in `notebook` directory are auto generated from `*.ipynb` files.

See:
- https://github.com/ipython/ipython/issues/8009
- https://jupyter-notebook.readthedocs.io/en/stable/extending/savehooks.html

## License

The MIT License; please see [LICENSE.txt](LICENSE.txt)
